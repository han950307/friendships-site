{% extends "friendship/base_generic_content.html" %}
{% load static %}
{% load friendship_extras %}

{% block title %} Your Orders {{ order.id }} {% endblock title %}
<!-- This page displays all the orders for the receiver. -->

{% block main_content %}
<hr>
	<div id="orders-header">
		<div class="row" id="orders-row">
			<div class="col-sm-13">Order</div>
			<div class="col-sm-13">Date</div>
			<div class="col-sm-13">Payment Status</div>
			<div class="col-sm-13">Order Status</div>
			<div class="col-sm-13">Amount</div>
		</div>
	</div>
<div class="container" id="orders-table">
	<div class="orders">
		{% for order in orders %}
		<div class="row">
			<!-- ORDER IMAGE -->
			<div class="col-sm-13"><a href="{% url 'friendship:order_details' order.id %}">
			{% if order.item_image %}
				<img src="{{ order.item_image.url }}" title="Order #{{ order.id }}">
			{% else %}
				<a href="{% url 'friendship:order_details' order.id %}">{{ order.id }}</a>
			{% endif %}
			</a></div>

			<!-- DATE -->
			<div class="col-sm-13 .font-weight-light">{{ order.date_placed|date }}</div>

			<!-- Payment Status -->
			<div class="col-sm-13">
				{% if order.latest_action.action < PAYMENT_RECEIVED or order.latest_action.action == ORDER_DECLINED %}
				<span class="btn btn-sm ui-gradient-negative">Unfulfilled</span>
				{% else %}
				<span class="btn btn-sm ui-gradient-positive">Fulfilled</span>
				{% endif %}
			</div>

			<!-- Order Status -->
			<div class="col-sm-13">
				{% if order.latest_action.action == MATCH_NOT_FOUND %}
				<span class="btn btn-sm ui-gradient-negative">Match not found</span>
				{% elif order.latest_action.action < MATCH_FOUND %}
				<span class="btn btn-sm ui-gradient-inprogress">Matching</span>
				{% elif order.latest_action.action >= MATCH_FOUND and order.latest_action.action < ORDER_FULFILLED %}
				<span class="btn btn-sm ui-gradient-found">Matched</span>
				{% elif order.latest_action.action == ORDER_FULFILLED %}
				<span class="btn btn-sm ui-gradient-positive">Delivered</span>
				{% elif order.latest_action.action == ORDER_DECLINED %}
				<span class="btn btn-sm ui-gradient-negative">Declined</span>
				{% elif order.latest_action.action < ORDER_CLOSED and order.latest_action.action > PAYMENT_RECEIVED %}
				<span class="btn btn-sm ui-gradient-purp">On the way</span>
				{% elif order.latest_action.action >= ORDER_CLOSED %}
				<span class="btn btn-sm ui-gradient-negative">Order Closed</span>
				{% endif %}
			</div>

			<!-- Amount -->
			<div class="col-sm-13">
				{% if order.final_bid != None %}
				<span>{% get_bid_total_str order.final_bid 100 %}</span>
				<!-- does not show if matching is in progre ss -->
				{% else %}
				<span>--</span>
				{% endif %}
			</div>
		</div>
		{% empty %}
		<p>No orders yet</p>
		{% endfor %}
	</div>
</div>
</table>
{% endblock main_content %}
